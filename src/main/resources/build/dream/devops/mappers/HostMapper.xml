<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="build.dream.devops.mappers.HostMapper">
    <select id="listHosts" resultType="build.dream.common.utils.UnderscoreToCamelCaseMap">
        SELECT
        host.id,
        host.type,
        host.parent_id,
        host.name AS host_name,
        host.ip_address,
        host.ssh_port,
        host.user_name,
        host.password,
        host.disk_size,
        host.cpu_core_quantity,
        host.memory_size,
        parent_host.name AS parent_name,
        parent_host.ip_address AS parent_ip_address
        FROM host LEFT JOIN host AS parent_host ON parent_host.id = host.parent_id AND parent_host.deleted = 0
        WHERE host.deleted = 0
        LIMIT #{offset}, #{maxResults}
    </select>

    <select id="countHosts" resultType="java.lang.Long">
        SELECT
        COUNT(1)
        FROM host LEFT JOIN host AS parent_host ON parent_host.id = host.parent_id AND parent_host.deleted = 0
        WHERE host.deleted = 0
    </select>
</mapper>